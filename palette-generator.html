<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Painting Palette Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header p {
            color: #666;
            font-size: 1.2em;
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            border: 2px solid #dee2e6;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .control-group label {
            font-weight: bold;
            color: #495057;
            font-size: 1.1em;
        }

        .control-group select {
            padding: 12px;
            border: 2px solid #ced4da;
            border-radius: 8px;
            font-size: 1em;
            background: white;
            transition: border-color 0.3s ease;
        }

        .control-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .generate-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            grid-column: 1 / -1;
            justify-self: center;
            margin-top: 10px;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .palette-display {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .palette-title {
            text-align: center;
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 25px;
            font-weight: bold;
        }

        .palette-colors {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .color-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            border: 2px solid #f8f9fa;
        }

        .color-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }

        .color-swatches {
            display: grid;
            grid-template-columns: 1fr;
            grid-template-rows: repeat(11, 1fr);
            gap: 1px;
            margin-bottom: 20px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-width: 200px;
            margin-left: auto;
            margin-right: auto;
        }

        .color-swatch {
            height: 80px;
            border: none;
            transition: transform 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .color-swatch:hover {
            transform: scale(1.08);
            z-index: 10;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .color-swatch::after {
            content: attr(data-lightness);
            position: absolute;
            bottom: 4px;
            right: 4px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            font-size: 0.8em;
            font-weight: bold;
            padding: 2px 6px;
            border-radius: 4px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .color-swatch:hover::after {
            opacity: 1;
        }

        .original-color {
            border: 3px solid #FFD700 !important;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5) !important;
            position: relative;
        }

        .original-color::before {
            content: '★';
            position: absolute;
            top: 5px;
            left: 5px;
            color: #FFD700;
            font-size: 1.2em;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            z-index: 5;
        }

        .color-info {
            text-align: center;
        }

        .color-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .color-values {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .color-variation {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .color-variation:hover {
            background: #e9ecef;
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .original-variation {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7) !important;
            border: 3px solid #FFD700 !important;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3) !important;
        }

        .original-variation .variation-label {
            color: #B8860B !important;
            font-weight: bold;
            font-size: 1.1em;
        }

        .variation-label {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1em;
            text-align: center;
        }

        .color-value {
            background: white;
            padding: 10px 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #495057;
            border: 2px solid #dee2e6;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 6px;
            font-weight: 500;
        }

        .color-value:hover {
            background: #e9ecef;
            border-color: #667eea;
            transform: scale(1.02);
        }

        .color-value:last-child {
            margin-bottom: 0;
        }

        .copy-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .copy-notification.show {
            transform: translateX(0);
        }

        .palette-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .action-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .action-btn:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .action-btn.primary {
            background: #007bff;
        }

        .action-btn.primary:hover {
            background: #0056b3;
        }

        .inspiration-section {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
        }

        .inspiration-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            text-align: center;
        }

        .inspiration-tips {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .tip-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .tip-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .tip-card p {
            color: #666;
            line-height: 1.6;
        }

        .palette-generator-2 {
            margin-top: 50px;
            padding-top: 30px;
            border-top: 3px solid #667eea;
        }

        .palette-generator-2 .header h1 {
            color: #667eea;
            font-size: 2.2em;
        }

        .palette-generator-2 .header p {
            color: #666;
            font-size: 1.1em;
        }

        .palette-generator-2 .controls {
            background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
            border: 2px solid #667eea;
        }

        .palette-generator-2 .generate-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: 2px solid #5a67d8;
        }

        .palette-generator-2 .generate-btn:hover {
            background: linear-gradient(135deg, #5a67d8, #6b46c1);
            transform: translateY(-3px);
            box-shadow: 0 15px 25px rgba(102, 126, 234, 0.4);
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
            
            .palette-colors {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎨 Digital Painting Palette Generator</h1>
            <p>Create professional tonal scales with 11 variations per color: 5 tints (white), original color, and 5 shades (black)</p>
        </div>

        <div class="controls">
            <div class="control-group">
                <label for="timeOfDay">Time of Day</label>
                <select id="timeOfDay">
                    <option value="dawn">🌅 Dawn</option>
                    <option value="morning">☀️ Morning</option>
                    <option value="noon">🌞 Noon</option>
                    <option value="afternoon">🌤️ Afternoon</option>
                    <option value="sunset">🌇 Sunset</option>
                    <option value="dusk">🌆 Dusk</option>
                    <option value="night">🌙 Night</option>
                    <option value="midnight">🌚 Midnight</option>
                </select>
            </div>

            <div class="control-group">
                <label for="weather">Weather Condition</label>
                <select id="weather">
                    <option value="clear">☀️ Clear</option>
                    <option value="cloudy">☁️ Cloudy</option>
                    <option value="overcast">☁️ Overcast</option>
                    <option value="rainy">🌧️ Rainy</option>
                    <option value="stormy">⛈️ Stormy</option>
                    <option value="foggy">🌫️ Foggy</option>
                    <option value="snowy">❄️ Snowy</option>
                    <option value="windy">💨 Windy</option>
                </select>
            </div>

            <div class="control-group">
                <label for="paletteType">Palette Type</label>
                <select id="paletteType">
                    <option value="themed">🎨 Themed (Time + Weather)</option>
                    <option value="random">🎲 Random</option>
                    <option value="monochromatic">🎭 Monochromatic</option>
                    <option value="complementary">🌈 Complementary</option>
                    <option value="analogous">🌊 Analogous</option>
                    <option value="triadic">🔺 Triadic</option>
                </select>
            </div>

            <button class="generate-btn" onclick="generatePalette()">Generate Palette</button>
            <button class="generate-btn" onclick="generateNewVariation()" id="newVariationBtn" style="display: none; background: linear-gradient(135deg, #28a745, #20c997);">Generate New Variation</button>
        </div>

        <div class="palette-display" id="paletteDisplay">
            <div class="palette-title" id="paletteTitle">Click "Generate Palette" to create your first palette!</div>
            <div class="palette-colors" id="paletteColors">
                <!-- Palette colors will be generated here -->
            </div>
            <div class="palette-actions" id="paletteActions" style="display: none;">
                <button class="action-btn primary" onclick="savePalette()">💾 Save Palette</button>
                <button class="action-btn" onclick="exportPalette()">📤 Export as JSON</button>
                <button class="action-btn" onclick="copyAllColors()">📋 Copy All Colors</button>
            </div>
        </div>

        <div class="inspiration-section">
            <h3>💡 Digital Painting Tips</h3>
            <div class="inspiration-tips">
                <div class="tip-card">
                    <h4>🎨 Color Theory</h4>
                    <p>Use complementary colors for contrast, analogous colors for harmony, and triadic colors for vibrant compositions.</p>
                </div>
                <div class="tip-card">
                    <h4>🌅 Time of Day</h4>
                    <p>Dawn and dusk offer warm, golden tones. Noon provides bright, saturated colors. Night brings cool, muted tones.</p>
                </div>
                <div class="tip-card">
                    <h4>🌤️ Weather Effects</h4>
                    <p>Clear skies = saturated colors. Cloudy weather = muted tones. Rainy conditions = cool, desaturated palettes.</p>
                </div>
                <div class="tip-card">
                    <h4>🎭 Mood & Atmosphere</h4>
                    <p>Warm colors create energy and happiness. Cool colors suggest calm and mystery. Use this to set your painting's mood.</p>
                </div>
            </div>
        </div>

        <!-- Second Palette Generator -->
        <div class="palette-generator-2">
            <div class="header">
                <h1>🎲 Advanced Random Palette Generator</h1>
                <p>Generate completely unique palettes with no color reuse for 24 hours</p>
            </div>

            <div class="controls">
                <div class="control-group">
                    <label for="timeOfDay2">Time of Day</label>
                    <select id="timeOfDay2">
                        <option value="dawn">🌅 Dawn</option>
                        <option value="morning">☀️ Morning</option>
                        <option value="noon">🌞 Noon</option>
                        <option value="afternoon">🌤️ Afternoon</option>
                        <option value="sunset">🌇 Sunset</option>
                        <option value="dusk">🌆 Dusk</option>
                        <option value="night">🌙 Night</option>
                        <option value="midnight">🌚 Midnight</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="weather2">Weather Condition</label>
                    <select id="weather2">
                        <option value="clear">☀️ Clear</option>
                        <option value="cloudy">☁️ Cloudy</option>
                        <option value="overcast">☁️ Overcast</option>
                        <option value="rainy">🌧️ Rainy</option>
                        <option value="stormy">⛈️ Stormy</option>
                        <option value="foggy">🌫️ Foggy</option>
                        <option value="snowy">❄️ Snowy</option>
                        <option value="windy">💨 Windy</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="paletteType2">Palette Type</label>
                    <select id="paletteType2">
                        <option value="themed">🎨 Themed (Time + Weather)</option>
                        <option value="random">🎲 Random</option>
                        <option value="monochromatic">🎭 Monochromatic</option>
                        <option value="complementary">🌈 Complementary</option>
                        <option value="analogous">🌊 Analogous</option>
                        <option value="triadic">🔺 Triadic</option>
                    </select>
                </div>

                <button class="generate-btn" onclick="generateAdvancedPalette()">Generate Unique Palette</button>
            </div>

            <div class="palette-display" id="paletteDisplay2">
                <div class="palette-title" id="paletteTitle2">Click "Generate Unique Palette" to create your first unique palette!</div>
                <div class="palette-colors" id="paletteColors2">
                    <!-- Advanced palette colors will be generated here -->
                </div>
                <div class="palette-actions" id="paletteActions2" style="display: none;">
                    <button class="action-btn primary" onclick="saveAdvancedPalette()">💾 Save Palette</button>
                    <button class="action-btn" onclick="exportAdvancedPalette()">📤 Export as JSON</button>
                    <button class="action-btn" onclick="copyAllAdvancedColors()">📋 Copy All Colors</button>
                </div>
            </div>
        </div>
    </div>

    <div class="copy-notification" id="copyNotification">
        Color copied to clipboard! 📋
    </div>

    <script>
        // Predefined palettes for different times and weather conditions
        const paletteDatabase = {
            dawn: {
                clear: ['#FFE4B5', '#FFB347', '#FF8C00', '#FF6347', '#FF4500'],
                cloudy: ['#F5DEB3', '#DEB887', '#CD853F', '#A0522D', '#8B4513'],
                overcast: ['#D3D3D3', '#C0C0C0', '#A9A9A9', '#808080', '#696969'],
                rainy: ['#B0C4DE', '#87CEEB', '#4682B4', '#5F9EA0', '#2F4F4F'],
                stormy: ['#2F4F4F', '#708090', '#4682B4', '#191970', '#000080'],
                foggy: ['#F0F8FF', '#E6E6FA', '#D3D3D3', '#C0C0C0', '#A9A9A9'],
                snowy: ['#FFFAF0', '#F0F8FF', '#E6E6FA', '#B0C4DE', '#87CEEB'],
                windy: ['#F5F5DC', '#F0E68C', '#DAA520', '#B8860B', '#CD853F']
            },
            morning: {
                clear: ['#FFE4B5', '#FFD700', '#FFA500', '#FF8C00', '#FF6347'],
                cloudy: ['#F5DEB3', '#DEB887', '#D2B48C', '#BC8F8F', '#A0522D'],
                overcast: ['#DCDCDC', '#C0C0C0', '#A9A9A9', '#808080', '#696969'],
                rainy: ['#B0C4DE', '#87CEEB', '#6495ED', '#4682B4', '#5F9EA0'],
                stormy: ['#2F4F4F', '#708090', '#4682B4', '#191970', '#000080'],
                foggy: ['#F0F8FF', '#E6E6FA', '#D3D3D3', '#C0C0C0', '#A9A9A9'],
                snowy: ['#FFFAF0', '#F0F8FF', '#E6E6FA', '#B0C4DE', '#87CEEB'],
                windy: ['#F5F5DC', '#F0E68C', '#DAA520', '#B8860B', '#CD853F']
            },
            noon: {
                clear: ['#FFD700', '#FFA500', '#FF8C00', '#FF6347', '#FF4500'],
                cloudy: ['#F5DEB3', '#DEB887', '#CD853F', '#A0522D', '#8B4513'],
                overcast: ['#D3D3D3', '#C0C0C0', '#A9A9A9', '#808080', '#696969'],
                rainy: ['#B0C4DE', '#87CEEB', '#4682B4', '#5F9EA0', '#2F4F4F'],
                stormy: ['#2F4F4F', '#708090', '#4682B4', '#191970', '#000080'],
                foggy: ['#F0F8FF', '#E6E6FA', '#D3D3D3', '#C0C0C0', '#A9A9A9'],
                snowy: ['#FFFAF0', '#F0F8FF', '#E6E6FA', '#B0C4DE', '#87CEEB'],
                windy: ['#F5F5DC', '#F0E68C', '#DAA520', '#B8860B', '#CD853F']
            },
            afternoon: {
                clear: ['#FFB347', '#FF8C00', '#FF6347', '#FF4500', '#DC143C'],
                cloudy: ['#DEB887', '#CD853F', '#A0522D', '#8B4513', '#654321'],
                overcast: ['#C0C0C0', '#A9A9A9', '#808080', '#696969', '#2F4F4F'],
                rainy: ['#87CEEB', '#4682B4', '#5F9EA0', '#2F4F4F', '#191970'],
                stormy: ['#708090', '#4682B4', '#191970', '#000080', '#000000'],
                foggy: ['#E6E6FA', '#D3D3D3', '#C0C0C0', '#A9A9A9', '#808080'],
                snowy: ['#F0F8FF', '#E6E6FA', '#B0C4DE', '#87CEEB', '#4682B4'],
                windy: ['#F0E68C', '#DAA520', '#B8860B', '#CD853F', '#A0522D']
            },
            sunset: {
                clear: ['#FF6347', '#FF4500', '#DC143C', '#B22222', '#8B0000'],
                cloudy: ['#CD853F', '#A0522D', '#8B4513', '#654321', '#2F4F4F'],
                overcast: ['#A9A9A9', '#808080', '#696969', '#2F4F4F', '#000000'],
                rainy: ['#4682B4', '#5F9EA0', '#2F4F4F', '#191970', '#000080'],
                stormy: ['#4682B4', '#191970', '#000080', '#000000', '#000000'],
                foggy: ['#D3D3D3', '#C0C0C0', '#A9A9A9', '#808080', '#696969'],
                snowy: ['#E6E6FA', '#B0C4DE', '#87CEEB', '#4682B4', '#191970'],
                windy: ['#DAA520', '#B8860B', '#CD853F', '#A0522D', '#8B4513']
            },
            dusk: {
                clear: ['#FF4500', '#DC143C', '#B22222', '#8B0000', '#4B0000'],
                cloudy: ['#A0522D', '#8B4513', '#654321', '#2F4F4F', '#000000'],
                overcast: ['#808080', '#696969', '#2F4F4F', '#000000', '#000000'],
                rainy: ['#5F9EA0', '#2F4F4F', '#191970', '#000080', '#000000'],
                stormy: ['#191970', '#000080', '#000000', '#000000', '#000000'],
                foggy: ['#C0C0C0', '#A9A9A9', '#808080', '#696969', '#2F4F4F'],
                snowy: ['#B0C4DE', '#87CEEB', '#4682B4', '#191970', '#000080'],
                windy: ['#B8860B', '#CD853F', '#A0522D', '#8B4513', '#654321']
            },
            night: {
                clear: ['#191970', '#000080', '#0000CD', '#4169E1', '#6495ED'],
                cloudy: ['#2F4F4F', '#000000', '#191970', '#000080', '#0000CD'],
                overcast: ['#000000', '#000000', '#191970', '#000080', '#0000CD'],
                rainy: ['#2F4F4F', '#191970', '#000080', '#0000CD', '#4169E1'],
                stormy: ['#000000', '#000000', '#191970', '#000080', '#0000CD'],
                foggy: ['#A9A9A9', '#808080', '#696969', '#2F4F4F', '#191970'],
                snowy: ['#87CEEB', '#4682B4', '#191970', '#000080', '#0000CD'],
                windy: ['#CD853F', '#A0522D', '#8B4513', '#654321', '#2F4F4F']
            },
            midnight: {
                clear: ['#000080', '#0000CD', '#4169E1', '#6495ED', '#87CEEB'],
                cloudy: ['#000000', '#191970', '#000080', '#0000CD', '#4169E1'],
                overcast: ['#000000', '#000000', '#191970', '#000080', '#0000CD'],
                rainy: ['#191970', '#000080', '#0000CD', '#4169E1', '#6495ED'],
                stormy: ['#000000', '#000000', '#191970', '#000080', '#0000CD'],
                foggy: ['#808080', '#696969', '#2F4F4F', '#191970', '#000080'],
                snowy: ['#4682B4', '#191970', '#000080', '#0000CD', '#4169E1'],
                windy: ['#A0522D', '#8B4513', '#654321', '#2F4F4F', '#191970']
            }
        };

        // Color theory palettes
        const colorTheoryPalettes = {
            monochromatic: [
                ['#FF6B6B', '#FF8E8E', '#FFB1B1', '#FFD4D4', '#FFF7F7'],
                ['#4ECDC4', '#6ED7D0', '#8EE1DC', '#AEEBE8', '#CEF5F4'],
                ['#45B7D1', '#65C5D9', '#85D3E1', '#A5E1E9', '#C5EFF1'],
                ['#96CEB4', '#A6D6C4', '#B6DED4', '#C6E6E4', '#D6EEF4']
            ],
            complementary: [
                ['#FF6B6B', '#4ECDC4', '#FF8E8E', '#6ED7D0', '#FFB1B1'],
                ['#45B7D1', '#FFB347', '#65C5D9', '#FFC966', '#85D3E1'],
                ['#96CEB4', '#FF6B6B', '#A6D6C4', '#FF8E8E', '#B6DED4'],
                ['#667EEA', '#FFB347', '#7A8FEC', '#FFC966', '#8EA0EE']
            ],
            analogous: [
                ['#FF6B6B', '#FF8E8E', '#FFB1B1', '#FFD4D4', '#FFF7F7'],
                ['#4ECDC4', '#45B7D1', '#96CEB4', '#6ED7D0', '#65C5D9'],
                ['#667EEA', '#764BA2', '#8A7EEA', '#9A8BEC', '#AA9EEE'],
                ['#FFB347', '#FF8C00', '#FFC966', '#FFD480', '#FFDF9A']
            ],
            triadic: [
                ['#FF6B6B', '#4ECDC4', '#96CEB4', '#FF8E8E', '#6ED7D0'],
                ['#45B7D1', '#FFB347', '#96CEB4', '#65C5D9', '#FFC966'],
                ['#667EEA', '#FF6B6B', '#4ECDC4', '#7A8FEC', '#FF8E8E'],
                ['#96CEB4', '#FF6B6B', '#45B7D1', '#A6D6C4', '#FF8E8E']
            ]
        };

        let currentPalette = [];

        function generatePalette() {
            const timeOfDay = document.getElementById('timeOfDay').value;
            const weather = document.getElementById('weather').value;
            const paletteType = document.getElementById('paletteType').value;

            let colors = [];

            if (paletteType === 'random') {
                colors = generateRandomPalette();
            } else if (paletteType === 'monochromatic' || paletteType === 'complementary' || 
                      paletteType === 'analogous' || paletteType === 'triadic') {
                const theoryPalettes = colorTheoryPalettes[paletteType];
                colors = theoryPalettes[Math.floor(Math.random() * theoryPalettes.length)];
            } else {
                // Themed palette based on time and weather with randomization
                colors = generateThemedPaletteWithVariations(timeOfDay, weather);
            }

            currentPalette = colors;
            displayPalette(colors, timeOfDay, weather, paletteType);
            
            // Show the "Generate New Variation" button for themed palettes
            if (paletteType === 'themed') {
                document.getElementById('newVariationBtn').style.display = 'block';
            } else {
                document.getElementById('newVariationBtn').style.display = 'none';
            }
        }

        function generateNewVariation() {
            const timeOfDay = document.getElementById('timeOfDay').value;
            const weather = document.getElementById('weather').value;
            
            // Generate a new variation of the same themed palette
            const colors = generateThemedPaletteWithVariations(timeOfDay, weather);
            currentPalette = colors;
            displayPalette(colors, timeOfDay, weather, 'themed');
        }

        function generateThemedPaletteWithVariations(timeOfDay, weather) {
            // Get the base palette
            const baseColors = paletteDatabase[timeOfDay][weather];
            const variations = [];
            
            // Generate 5 colors with variations
            for (let i = 0; i < 5; i++) {
                const baseColor = baseColors[i];
                const variation = generateThemedColorVariation(baseColor, timeOfDay, weather);
                variations.push(variation);
            }
            
            return variations;
        }

        function generateThemedColorVariation(baseColor, timeOfDay, weather) {
            // Convert base color to HSL for manipulation
            let baseHsl;
            if (baseColor.startsWith('hsl')) {
                baseHsl = baseColor;
            } else {
                baseHsl = colorToHsl(baseColor);
            }
            
            const hslValues = baseHsl.match(/\d+/g);
            let baseH = parseInt(hslValues[0]);
            let baseS = parseInt(hslValues[1]);
            let baseL = parseInt(hslValues[2]);
            
            // Apply themed variations based on time and weather
            const variations = getThemedVariations(timeOfDay, weather);
            const variation = variations[Math.floor(Math.random() * variations.length)];
            
            // Apply the variation
            baseH = Math.max(0, Math.min(360, baseH + variation.hueShift));
            baseS = Math.max(10, Math.min(100, baseS + variation.saturationShift));
            baseL = Math.max(5, Math.min(95, baseL + variation.lightnessShift));
            
            return `hsl(${baseH}, ${baseS}%, ${baseL}%)`;
        }

        function getThemedVariations(timeOfDay, weather) {
            const variations = {
                dawn: {
                    clear: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 10, saturationShift: 10, lightnessShift: 5 },
                        { hueShift: -5, saturationShift: -5, lightnessShift: -3 },
                        { hueShift: 15, saturationShift: 15, lightnessShift: 8 },
                        { hueShift: -10, saturationShift: 5, lightnessShift: 3 }
                    ],
                    cloudy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 5, saturationShift: -10, lightnessShift: 5 },
                        { hueShift: -5, saturationShift: -15, lightnessShift: 3 },
                        { hueShift: 8, saturationShift: -5, lightnessShift: 8 },
                        { hueShift: -8, saturationShift: -8, lightnessShift: 2 }
                    ],
                    overcast: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 3, saturationShift: -20, lightnessShift: 5 },
                        { hueShift: -3, saturationShift: -25, lightnessShift: 3 },
                        { hueShift: 5, saturationShift: -15, lightnessShift: 8 },
                        { hueShift: -5, saturationShift: -18, lightnessShift: 2 }
                    ],
                    rainy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 20, saturationShift: -10, lightnessShift: 5 },
                        { hueShift: -15, saturationShift: -15, lightnessShift: 3 },
                        { hueShift: 25, saturationShift: -5, lightnessShift: 8 },
                        { hueShift: -20, saturationShift: -12, lightnessShift: 2 }
                    ],
                    stormy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 15, saturationShift: -20, lightnessShift: -5 },
                        { hueShift: -10, saturationShift: -25, lightnessShift: -8 },
                        { hueShift: 20, saturationShift: -15, lightnessShift: -3 },
                        { hueShift: -15, saturationShift: -18, lightnessShift: -10 }
                    ],
                    foggy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 5, saturationShift: -30, lightnessShift: 10 },
                        { hueShift: -5, saturationShift: -35, lightnessShift: 8 },
                        { hueShift: 8, saturationShift: -25, lightnessShift: 12 },
                        { hueShift: -8, saturationShift: -28, lightnessShift: 6 }
                    ],
                    snowy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 30, saturationShift: -20, lightnessShift: 15 },
                        { hueShift: -25, saturationShift: -25, lightnessShift: 12 },
                        { hueShift: 35, saturationShift: -15, lightnessShift: 18 },
                        { hueShift: -30, saturationShift: -22, lightnessShift: 10 }
                    ],
                    windy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 8, saturationShift: 5, lightnessShift: 3 },
                        { hueShift: -8, saturationShift: 3, lightnessShift: 2 },
                        { hueShift: 12, saturationShift: 8, lightnessShift: 5 },
                        { hueShift: -12, saturationShift: 6, lightnessShift: 4 }
                    ]
                },
                morning: {
                    clear: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 5, saturationShift: 15, lightnessShift: 8 },
                        { hueShift: -5, saturationShift: 10, lightnessShift: 5 },
                        { hueShift: 8, saturationShift: 20, lightnessShift: 10 },
                        { hueShift: -8, saturationShift: 12, lightnessShift: 6 }
                    ],
                    cloudy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 3, saturationShift: -5, lightnessShift: 8 },
                        { hueShift: -3, saturationShift: -8, lightnessShift: 5 },
                        { hueShift: 5, saturationShift: -3, lightnessShift: 10 },
                        { hueShift: -5, saturationShift: -6, lightnessShift: 6 }
                    ],
                    overcast: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 2, saturationShift: -15, lightnessShift: 8 },
                        { hueShift: -2, saturationShift: -18, lightnessShift: 5 },
                        { hueShift: 4, saturationShift: -12, lightnessShift: 10 },
                        { hueShift: -4, saturationShift: -15, lightnessShift: 6 }
                    ],
                    rainy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 15, saturationShift: -8, lightnessShift: 8 },
                        { hueShift: -12, saturationShift: -12, lightnessShift: 5 },
                        { hueShift: 18, saturationShift: -5, lightnessShift: 10 },
                        { hueShift: -15, saturationShift: -10, lightnessShift: 6 }
                    ],
                    stormy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 10, saturationShift: -15, lightnessShift: -3 },
                        { hueShift: -8, saturationShift: -18, lightnessShift: -5 },
                        { hueShift: 12, saturationShift: -12, lightnessShift: -2 },
                        { hueShift: -10, saturationShift: -15, lightnessShift: -6 }
                    ],
                    foggy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 3, saturationShift: -25, lightnessShift: 12 },
                        { hueShift: -3, saturationShift: -28, lightnessShift: 8 },
                        { hueShift: 5, saturationShift: -22, lightnessShift: 15 },
                        { hueShift: -5, saturationShift: -25, lightnessShift: 10 }
                    ],
                    snowy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 20, saturationShift: -15, lightnessShift: 18 },
                        { hueShift: -18, saturationShift: -20, lightnessShift: 15 },
                        { hueShift: 25, saturationShift: -12, lightnessShift: 20 },
                        { hueShift: -22, saturationShift: -18, lightnessShift: 12 }
                    ],
                    windy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 6, saturationShift: 8, lightnessShift: 5 },
                        { hueShift: -6, saturationShift: 5, lightnessShift: 3 },
                        { hueShift: 10, saturationShift: 12, lightnessShift: 8 },
                        { hueShift: -10, saturationShift: 8, lightnessShift: 6 }
                    ]
                },
                noon: {
                    clear: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 8, saturationShift: 20, lightnessShift: 10 },
                        { hueShift: -8, saturationShift: 15, lightnessShift: 8 },
                        { hueShift: 12, saturationShift: 25, lightnessShift: 12 },
                        { hueShift: -12, saturationShift: 18, lightnessShift: 10 }
                    ],
                    cloudy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 5, saturationShift: -3, lightnessShift: 10 },
                        { hueShift: -5, saturationShift: -5, lightnessShift: 8 },
                        { hueShift: 8, saturationShift: -2, lightnessShift: 12 },
                        { hueShift: -8, saturationShift: -4, lightnessShift: 10 }
                    ],
                    overcast: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 3, saturationShift: -12, lightnessShift: 10 },
                        { hueShift: -3, saturationShift: -15, lightnessShift: 8 },
                        { hueShift: 5, saturationShift: -10, lightnessShift: 12 },
                        { hueShift: -5, saturationShift: -12, lightnessShift: 10 }
                    ],
                    rainy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 18, saturationShift: -5, lightnessShift: 10 },
                        { hueShift: -15, saturationShift: -8, lightnessShift: 8 },
                        { hueShift: 22, saturationShift: -3, lightnessShift: 12 },
                        { hueShift: -18, saturationShift: -6, lightnessShift: 10 }
                    ],
                    stormy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 12, saturationShift: -12, lightnessShift: -2 },
                        { hueShift: -10, saturationShift: -15, lightnessShift: -4 },
                        { hueShift: 15, saturationShift: -10, lightnessShift: -1 },
                        { hueShift: -12, saturationShift: -12, lightnessShift: -5 }
                    ],
                    foggy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 4, saturationShift: -22, lightnessShift: 15 },
                        { hueShift: -4, saturationShift: -25, lightnessShift: 12 },
                        { hueShift: 6, saturationShift: -20, lightnessShift: 18 },
                        { hueShift: -6, saturationShift: -22, lightnessShift: 14 }
                    ],
                    snowy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 25, saturationShift: -12, lightnessShift: 20 },
                        { hueShift: -22, saturationShift: -15, lightnessShift: 18 },
                        { hueShift: 30, saturationShift: -10, lightnessShift: 22 },
                        { hueShift: -25, saturationShift: -12, lightnessShift: 16 }
                    ],
                    windy: [
                        { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                        { hueShift: 8, saturationShift: 10, lightnessShift: 8 },
                        { hueShift: -8, saturationShift: 8, lightnessShift: 6 },
                        { hueShift: 12, saturationShift: 15, lightnessShift: 10 },
                        { hueShift: -12, saturationShift: 12, lightnessShift: 8 }
                    ]
                }
            };
            
            return variations[timeOfDay]?.[weather] || [
                { hueShift: 0, saturationShift: 0, lightnessShift: 0 },
                { hueShift: 10, saturationShift: 10, lightnessShift: 5 },
                { hueShift: -10, saturationShift: -10, lightnessShift: -5 },
                { hueShift: 15, saturationShift: 15, lightnessShift: 8 },
                { hueShift: -15, saturationShift: -15, lightnessShift: -8 }
            ];
        }

        function generateRandomPalette() {
            const colors = [];
            
            // Generate 5 completely random colors with varied characteristics
            for (let i = 0; i < 5; i++) {
                colors.push(generateRandomColor());
            }
            
            // Occasionally add some wild card colors for extra randomness
            if (Math.random() < 0.3) { // 30% chance
                colors.push(generateWildCardColor());
            }
            
            return colors;
        }

        function generateWildCardColor() {
            // Generate extremely random colors - neon, pastel, or unusual combinations
            const wildCardTypes = [
                () => {
                    // Neon colors
                    const hue = Math.floor(Math.random() * 360);
                    return `hsl(${hue}, 100%, 50%)`;
                },
                () => {
                    // Pastel colors
                    const hue = Math.floor(Math.random() * 360);
                    return `hsl(${hue}, 30%, 85%)`;
                },
                () => {
                    // Earth tones
                    const earthHues = [20, 30, 40, 50, 60, 25, 35, 45]; // Browns, oranges, yellows
                    const hue = earthHues[Math.floor(Math.random() * earthHues.length)];
                    const saturation = Math.floor(Math.random() * 40) + 40;
                    const lightness = Math.floor(Math.random() * 30) + 30;
                    return `hsl(${hue}, ${saturation}%, ${lightness}%)`;
                },
                () => {
                    // Cool tones
                    const coolHues = [180, 200, 220, 240, 260, 280, 300, 320]; // Blues, purples, cyans
                    const hue = coolHues[Math.floor(Math.random() * coolHues.length)];
                    const saturation = Math.floor(Math.random() * 60) + 40;
                    const lightness = Math.floor(Math.random() * 50) + 25;
                    return `hsl(${hue}, ${saturation}%, ${lightness}%)`;
                },
                () => {
                    // Warm tones
                    const warmHues = [0, 15, 30, 45, 60, 75, 90, 105]; // Reds, oranges, yellows
                    const hue = warmHues[Math.floor(Math.random() * warmHues.length)];
                    const saturation = Math.floor(Math.random() * 60) + 40;
                    const lightness = Math.floor(Math.random() * 50) + 25;
                    return `hsl(${hue}, ${saturation}%, ${lightness}%)`;
                }
            ];
            
            const randomType = wildCardTypes[Math.floor(Math.random() * wildCardTypes.length)];
            return randomType();
        }

        function generateRandomColor() {
            // Completely random hue (0-360)
            const hue = Math.floor(Math.random() * 360);
            
            // Random saturation with different ranges for variety
            const saturationRanges = [
                [10, 30],   // Very muted colors
                [35, 55],   // Muted colors
                [60, 80],   // Medium saturation
                [85, 100]   // Highly saturated
            ];
            const satRange = saturationRanges[Math.floor(Math.random() * saturationRanges.length)];
            const saturation = Math.floor(Math.random() * (satRange[1] - satRange[0] + 1)) + satRange[0];
            
            // Random lightness with different ranges for variety
            const lightnessRanges = [
                [5, 25],    // Very dark colors
                [30, 50],   // Dark colors
                [55, 75],   // Medium colors
                [80, 95]    // Light colors
            ];
            const lightRange = lightnessRanges[Math.floor(Math.random() * lightnessRanges.length)];
            const lightness = Math.floor(Math.random() * (lightRange[1] - lightRange[0] + 1)) + lightRange[0];
            
            // Occasionally create extreme colors (very saturated or very muted)
            if (Math.random() < 0.15) { // 15% chance
                if (Math.random() < 0.5) {
                    // Very saturated
                    return `hsl(${hue}, 100%, ${lightness}%)`;
                } else {
                    // Very muted
                    return `hsl(${hue}, ${Math.floor(Math.random() * 20) + 5}%, ${lightness}%)`;
                }
            }
            
            return `hsl(${hue}, ${saturation}%, ${lightness}%)`;
        }

        function displayPalette(colors, timeOfDay, weather, paletteType) {
            const paletteTitle = document.getElementById('paletteTitle');
            const paletteColors = document.getElementById('paletteColors');
            const paletteActions = document.getElementById('paletteActions');

            // Generate title
            let title = '';
            if (paletteType === 'random') {
                title = '🎲 Random Palette';
            } else if (paletteType === 'monochromatic' || paletteType === 'complementary' || 
                      paletteType === 'analogous' || paletteType === 'triadic') {
                title = `🎨 ${paletteType.charAt(0).toUpperCase() + paletteType.slice(1)} Palette`;
            } else {
                const timeEmoji = document.querySelector(`#timeOfDay option[value="${timeOfDay}"]`).textContent.split(' ')[0];
                const weatherEmoji = document.querySelector(`#weather option[value="${weather}"]`).textContent.split(' ')[0];
                title = `${timeEmoji} ${timeOfDay.charAt(0).toUpperCase() + timeOfDay.slice(1)} ${weatherEmoji} ${weather.charAt(0).toUpperCase() + weather.slice(1)}`;
            }

            paletteTitle.textContent = title;

            // Generate color cards with multiple variations
            paletteColors.innerHTML = '';
            colors.forEach((color, index) => {
                const colorVariations = generateColorVariations(color, 5);
                const colorCard = createColorCard(color, colorVariations, index);
                paletteColors.appendChild(colorCard);
            });

            paletteActions.style.display = 'flex';
        }

        function generateColorVariations(baseColor, count) {
            const variations = [];
            
            // Convert base color to RGB for accurate mixing
            let baseRgb;
            if (baseColor.startsWith('#')) {
                baseRgb = hexToRgb(baseColor);
            } else if (baseColor.startsWith('rgb')) {
                const values = baseColor.match(/\d+/g);
                baseRgb = { r: parseInt(values[0]), g: parseInt(values[1]), b: parseInt(values[2]) };
            } else if (baseColor.startsWith('hsl')) {
                baseRgb = hslToRgb(baseColor);
            }
            
            // Generate 5 tints (adding white) - lightest to base
            for (let i = 4; i >= 0; i--) {
                const whiteAmount = i * 0.2; // 80%, 60%, 40%, 20%, 0% white
                const tint = mixWithWhite(baseRgb, whiteAmount);
                variations.push(tint);
            }
            
            // Add the original saturated color (most prominent)
            variations.push(`rgb(${baseRgb.r}, ${baseRgb.g}, ${baseRgb.b})`);
            
            // Generate 5 shades (adding black) - base to darkest
            for (let i = 1; i <= 5; i++) {
                const blackAmount = i * 0.15; // 15%, 30%, 45%, 60%, 75% black
                const shade = mixWithBlack(baseRgb, blackAmount);
                variations.push(shade);
            }
            
            // Sort all variations by lightness (lightest to darkest)
            return sortColorsByLightness(variations);
        }

        function mixWithWhite(rgb, whiteAmount) {
            const mixedR = Math.round(rgb.r + (255 - rgb.r) * whiteAmount);
            const mixedG = Math.round(rgb.g + (255 - rgb.g) * whiteAmount);
            const mixedB = Math.round(rgb.b + (255 - rgb.b) * whiteAmount);
            
            return `rgb(${mixedR}, ${mixedG}, ${mixedB})`;
        }

        function mixWithBlack(rgb, blackAmount) {
            // Mix with black
            const mixedR = Math.round(rgb.r * (1 - blackAmount));
            const mixedG = Math.round(rgb.g * (1 - blackAmount));
            const mixedB = Math.round(rgb.b * (1 - blackAmount));
            
            return `rgb(${mixedR}, ${mixedG}, ${mixedB})`;
        }

        function sortColorsByLightness(colors) {
            return colors.sort((a, b) => {
                const lightnessA = getColorLightness(a);
                const lightnessB = getColorLightness(b);
                return lightnessB - lightnessA; // Darkest to lightest
            });
        }

        function getColorLightness(color) {
            let rgb;
            if (color.startsWith('#')) {
                rgb = hexToRgb(color);
            } else if (color.startsWith('rgb')) {
                const values = color.match(/\d+/g);
                rgb = { r: parseInt(values[0]), g: parseInt(values[1]), b: parseInt(values[2]) };
            } else if (color.startsWith('hsl')) {
                rgb = hslToRgb(color);
            }
            
            // Calculate relative luminance
            const r = rgb.r / 255;
            const g = rgb.g / 255;
            const b = rgb.b / 255;
            
            // Apply gamma correction
            const rLinear = r <= 0.03928 ? r / 12.92 : Math.pow((r + 0.055) / 1.055, 2.4);
            const gLinear = g <= 0.03928 ? g / 12.92 : Math.pow((g + 0.055) / 1.055, 2.4);
            const bLinear = b <= 0.03928 ? b / 12.92 : Math.pow((b + 0.055) / 1.055, 2.4);
            
            // Calculate relative luminance
            return 0.2126 * rLinear + 0.7152 * gLinear + 0.0722 * bLinear;
        }

        function createColorCard(baseColor, colorVariations, index) {
            const card = document.createElement('div');
            card.className = 'color-card';

            // Create color swatches for all variations with lightness data
            const swatchesHtml = colorVariations.map((color, i) => {
                const lightness = Math.round(getColorLightness(color) * 100);
                const isOriginal = i === 5; // The 6th color (index 5) is the original
                const swatchClass = isOriginal ? 'color-swatch original-color' : 'color-swatch';
                const title = isOriginal ? `ORIGINAL COLOR (${lightness}% lightness)` : `Variation ${i + 1} (${lightness}% lightness)`;
                
                return `<div class="${swatchClass}" style="background-color: ${color}" 
                        title="${title}" 
                        data-lightness="${lightness}%"></div>`;
            }).join('');

            // Create color values for all variations
            const valuesHtml = colorVariations.map((color, i) => {
                const hex = colorToHex(color);
                const rgb = colorToRgb(color);
                const hsl = colorToHsl(color);
                const lightness = Math.round(getColorLightness(color) * 100);
                const isOriginal = i === 5;
                const label = isOriginal ? `ORIGINAL COLOR (${lightness}% lightness)` : `Variation ${i + 1} (${lightness}% lightness)`;
                const variationClass = isOriginal ? 'color-variation original-variation' : 'color-variation';
                
                return `
                    <div class="${variationClass}">
                        <div class="variation-label">${label}</div>
                        <div class="color-value" onclick="copyToClipboard('${hex}')">HEX: ${hex}</div>
                        <div class="color-value" onclick="copyToClipboard('${rgb}')">RGB: ${rgb}</div>
                        <div class="color-value" onclick="copyToClipboard('${hsl}')">HSL: ${hsl}</div>
                    </div>
                `;
            }).join('');

            card.innerHTML = `
                <div class="color-swatches">${swatchesHtml}</div>
                <div class="color-info">
                    <div class="color-name">Color ${index + 1} - Tonal Scale (Lightest to Darkest)</div>
                    <div class="color-values">
                        ${valuesHtml}
                    </div>
                </div>
            `;

            return card;
        }

        function colorToHex(color) {
            if (color.startsWith('#')) return color.toUpperCase();
            
            // Convert HSL to HEX
            if (color.startsWith('hsl')) {
                const rgb = hslToRgb(color);
                return rgbToHex(rgb);
            }
            
            return color.toUpperCase();
        }

        function colorToRgb(color) {
            if (color.startsWith('rgb')) return color;
            
            if (color.startsWith('hsl')) {
                const rgb = hslToRgb(color);
                return `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
            }
            
            if (color.startsWith('#')) {
                const rgb = hexToRgb(color);
                return `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
            }
            
            return color;
        }

        function colorToHsl(color) {
            if (color.startsWith('hsl')) return color;
            
            let rgb;
            if (color.startsWith('#')) {
                rgb = hexToRgb(color);
            } else if (color.startsWith('rgb')) {
                const values = color.match(/\d+/g);
                rgb = { r: parseInt(values[0]), g: parseInt(values[1]), b: parseInt(values[2]) };
            }
            
            return rgbToHsl(rgb);
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        }

        function rgbToHex(rgb) {
            return "#" + ((1 << 24) + (rgb.r << 16) + (rgb.g << 8) + rgb.b).toString(16).slice(1).toUpperCase();
        }

        function rgbToHsl(rgb) {
            const r = rgb.r / 255;
            const g = rgb.g / 255;
            const b = rgb.b / 255;

            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;

            if (max === min) {
                h = s = 0;
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
            }

            return `hsl(${Math.round(h * 360)}, ${Math.round(s * 100)}%, ${Math.round(l * 100)}%)`;
        }

        function hslToRgb(hsl) {
            const values = hsl.match(/\d+/g);
            const h = parseInt(values[0]) / 360;
            const s = parseInt(values[1]) / 100;
            const l = parseInt(values[2]) / 100;

            let r, g, b;

            if (s === 0) {
                r = g = b = l;
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };

                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }

            return {
                r: Math.round(r * 255),
                g: Math.round(g * 255),
                b: Math.round(b * 255)
            };
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showCopyNotification();
            });
        }

        function showCopyNotification() {
            const notification = document.getElementById('copyNotification');
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 2000);
        }

        function savePalette() {
            // Collect all color variations from the current display
            const colorCards = document.querySelectorAll('.color-card');
            let allColorVariations = [];
            
            colorCards.forEach(card => {
                const variations = card.querySelectorAll('.color-variation');
                variations.forEach(variation => {
                    const hexValue = variation.querySelector('.color-value').textContent.replace('HEX: ', '');
                    allColorVariations.push(hexValue);
                });
            });
            
            const paletteData = {
                title: document.getElementById('paletteTitle').textContent,
                baseColors: currentPalette,
                allVariations: allColorVariations,
                timestamp: new Date().toISOString()
            };
            
            // Save to localStorage
            const savedPalettes = JSON.parse(localStorage.getItem('savedPalettes') || '[]');
            savedPalettes.push(paletteData);
            localStorage.setItem('savedPalettes', JSON.stringify(savedPalettes));
            
            showCopyNotification();
            document.getElementById('copyNotification').textContent = 'Palette with all variations saved! 💾';
        }

        function exportPalette() {
            // Collect all color variations from the current display
            const colorCards = document.querySelectorAll('.color-card');
            let allColorVariations = [];
            
            colorCards.forEach(card => {
                const variations = card.querySelectorAll('.color-variation');
                variations.forEach(variation => {
                    const hexValue = variation.querySelector('.color-value').textContent.replace('HEX: ', '');
                    allColorVariations.push(hexValue);
                });
            });
            
            const paletteData = {
                title: document.getElementById('paletteTitle').textContent,
                baseColors: currentPalette,
                allVariations: allColorVariations,
                timestamp: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(paletteData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `palette-${Date.now()}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
        }

        function copyAllColors() {
            // Get all color variations from the current display
            const colorCards = document.querySelectorAll('.color-card');
            let allColors = [];
            
            colorCards.forEach(card => {
                const variations = card.querySelectorAll('.color-variation');
                variations.forEach(variation => {
                    const hexValue = variation.querySelector('.color-value').textContent.replace('HEX: ', '');
                    allColors.push(hexValue);
                });
            });
            
            const colorValues = allColors.join('\n');
            copyToClipboard(colorValues);
            document.getElementById('copyNotification').textContent = `All ${allColors.length} color variations copied! 📋`;
        }

        // Advanced Palette Generator Variables
        let advancedCurrentPalette = [];
        let usedColors = new Set();
        let lastResetDate = new Date().toDateString();

        // Advanced Palette Generation Functions
        function generateAdvancedPalette() {
            const timeOfDay = document.getElementById('timeOfDay2').value;
            const weather = document.getElementById('weather2').value;
            const paletteType = document.getElementById('paletteType2').value;

            // Check if we need to reset used colors (new day)
            const currentDate = new Date().toDateString();
            if (currentDate !== lastResetDate) {
                usedColors.clear();
                lastResetDate = currentDate;
            }

            let colors = [];

            if (paletteType === 'random') {
                colors = generateUniqueRandomPalette();
            } else if (paletteType === 'monochromatic' || paletteType === 'complementary' || 
                      paletteType === 'analogous' || paletteType === 'triadic') {
                colors = generateUniqueTheoryPalette(paletteType);
            } else {
                colors = generateUniqueThemedPalette(timeOfDay, weather);
            }

            advancedCurrentPalette = colors;
            displayAdvancedPalette(colors, timeOfDay, weather, paletteType);
        }

        function generateUniqueRandomPalette() {
            const colors = [];
            let attempts = 0;
            const maxAttempts = 100;

            while (colors.length < 5 && attempts < maxAttempts) {
                const color = generateCompletelyRandomColor();
                const colorKey = colorToHex(color);
                
                if (!usedColors.has(colorKey)) {
                    colors.push(color);
                    usedColors.add(colorKey);
                }
                attempts++;
            }

            // If we can't find enough unique colors, generate wild variations
            while (colors.length < 5) {
                const baseColor = colors[Math.floor(Math.random() * colors.length)] || generateCompletelyRandomColor();
                const variation = generateWildVariation(baseColor);
                const colorKey = colorToHex(variation);
                
                if (!usedColors.has(colorKey)) {
                    colors.push(variation);
                    usedColors.add(colorKey);
                }
            }

            return colors;
        }

        function generateUniqueTheoryPalette(paletteType) {
            const colors = [];
            const theoryPalettes = colorTheoryPalettes[paletteType];
            const basePalette = theoryPalettes[Math.floor(Math.random() * theoryPalettes.length)];
            
            for (const baseColor of basePalette) {
                let uniqueColor = baseColor;
                let attempts = 0;
                const maxAttempts = 50;

                while (usedColors.has(colorToHex(uniqueColor)) && attempts < maxAttempts) {
                    uniqueColor = generateTheoryVariation(baseColor, paletteType);
                    attempts++;
                }

                colors.push(uniqueColor);
                usedColors.add(colorToHex(uniqueColor));
            }

            return colors;
        }

        function generateUniqueThemedPalette(timeOfDay, weather) {
            const colors = [];
            const baseColors = paletteDatabase[timeOfDay][weather];
            
            for (const baseColor of baseColors) {
                let uniqueColor = baseColor;
                let attempts = 0;
                const maxAttempts = 50;

                while (usedColors.has(colorToHex(uniqueColor)) && attempts < maxAttempts) {
                    uniqueColor = generateThemedVariation(baseColor, timeOfDay, weather);
                    attempts++;
                }

                colors.push(uniqueColor);
                usedColors.add(colorToHex(uniqueColor));
            }

            return colors;
        }

        function generateCompletelyRandomColor() {
            // Generate completely random color with no constraints
            const hue = Math.floor(Math.random() * 360);
            const saturation = Math.floor(Math.random() * 100) + 1; // 1-100%
            const lightness = Math.floor(Math.random() * 100) + 1; // 1-100%
            
            return `hsl(${hue}, ${saturation}%, ${lightness}%)`;
        }

        function generateWildVariation(baseColor) {
            // Convert to HSL for manipulation
            let baseHsl = colorToHsl(baseColor);
            const hslValues = baseHsl.match(/\d+/g);
            let baseH = parseInt(hslValues[0]);
            let baseS = parseInt(hslValues[1]);
            let baseL = parseInt(hslValues[2]);
            
            // Apply wild variations
            const hueShift = (Math.random() - 0.5) * 60; // ±30 degrees
            const satShift = (Math.random() - 0.5) * 60; // ±30%
            const lightShift = (Math.random() - 0.5) * 60; // ±30%
            
            const newH = Math.max(0, Math.min(360, baseH + hueShift));
            const newS = Math.max(1, Math.min(100, baseS + satShift));
            const newL = Math.max(1, Math.min(100, baseL + lightShift));
            
            return `hsl(${Math.round(newH)}, ${Math.round(newS)}%, ${Math.round(newL)}%)`;
        }

        function generateTheoryVariation(baseColor, paletteType) {
            let baseHsl = colorToHsl(baseColor);
            const hslValues = baseHsl.match(/\d+/g);
            let baseH = parseInt(hslValues[0]);
            let baseS = parseInt(hslValues[1]);
            let baseL = parseInt(hslValues[2]);
            
            // Apply theory-specific variations
            let hueShift, satShift, lightShift;
            
            switch (paletteType) {
                case 'monochromatic':
                    hueShift = (Math.random() - 0.5) * 20; // ±10 degrees
                    satShift = (Math.random() - 0.5) * 40; // ±20%
                    lightShift = (Math.random() - 0.5) * 40; // ±20%
                    break;
                case 'complementary':
                    hueShift = (Math.random() - 0.5) * 30; // ±15 degrees
                    satShift = (Math.random() - 0.5) * 30; // ±15%
                    lightShift = (Math.random() - 0.5) * 30; // ±15%
                    break;
                case 'analogous':
                    hueShift = (Math.random() - 0.5) * 40; // ±20 degrees
                    satShift = (Math.random() - 0.5) * 20; // ±10%
                    lightShift = (Math.random() - 0.5) * 20; // ±10%
                    break;
                case 'triadic':
                    hueShift = (Math.random() - 0.5) * 50; // ±25 degrees
                    satShift = (Math.random() - 0.5) * 25; // ±12.5%
                    lightShift = (Math.random() - 0.5) * 25; // ±12.5%
                    break;
                default:
                    hueShift = (Math.random() - 0.5) * 30;
                    satShift = (Math.random() - 0.5) * 30;
                    lightShift = (Math.random() - 0.5) * 30;
            }
            
            const newH = Math.max(0, Math.min(360, baseH + hueShift));
            const newS = Math.max(1, Math.min(100, baseS + satShift));
            const newL = Math.max(1, Math.min(100, baseL + lightShift));
            
            return `hsl(${Math.round(newH)}, ${Math.round(newS)}%, ${Math.round(newL)}%)`;
        }

        function generateThemedVariation(baseColor, timeOfDay, weather) {
            let baseHsl = colorToHsl(baseColor);
            const hslValues = baseHsl.match(/\d+/g);
            let baseH = parseInt(hslValues[0]);
            let baseS = parseInt(hslValues[1]);
            let baseL = parseInt(hslValues[2]);
            
            // Apply themed variations with more randomness
            const variations = getThemedVariations(timeOfDay, weather);
            const variation = variations[Math.floor(Math.random() * variations.length)];
            
            // Add extra randomness
            const extraHueShift = (Math.random() - 0.5) * 20;
            const extraSatShift = (Math.random() - 0.5) * 20;
            const extraLightShift = (Math.random() - 0.5) * 20;
            
            const newH = Math.max(0, Math.min(360, baseH + variation.hueShift + extraHueShift));
            const newS = Math.max(1, Math.min(100, baseS + variation.saturationShift + extraSatShift));
            const newL = Math.max(1, Math.min(100, baseL + variation.lightnessShift + extraLightShift));
            
            return `hsl(${Math.round(newH)}, ${Math.round(newS)}%, ${Math.round(newL)}%)`;
        }

        function displayAdvancedPalette(colors, timeOfDay, weather, paletteType) {
            const paletteTitle = document.getElementById('paletteTitle2');
            const paletteColors = document.getElementById('paletteColors2');
            const paletteActions = document.getElementById('paletteActions2');

            // Generate title
            let title = '';
            if (paletteType === 'random') {
                title = '🎲 Unique Random Palette';
            } else if (paletteType === 'monochromatic' || paletteType === 'complementary' || 
                      paletteType === 'analogous' || paletteType === 'triadic') {
                title = `🎨 Unique ${paletteType.charAt(0).toUpperCase() + paletteType.slice(1)} Palette`;
            } else {
                const timeEmoji = document.querySelector(`#timeOfDay2 option[value="${timeOfDay}"]`).textContent.split(' ')[0];
                const weatherEmoji = document.querySelector(`#weather2 option[value="${weather}"]`).textContent.split(' ')[0];
                title = `${timeEmoji} Unique ${timeOfDay.charAt(0).toUpperCase() + timeOfDay.slice(1)} ${weatherEmoji} ${weather.charAt(0).toUpperCase() + weather.slice(1)}`;
            }

            paletteTitle.textContent = title;

            // Generate color cards with multiple variations
            paletteColors.innerHTML = '';
            colors.forEach((color, index) => {
                const colorVariations = generateColorVariations(color, 5);
                const colorCard = createColorCard(color, colorVariations, index);
                paletteColors.appendChild(colorCard);
            });

            paletteActions.style.display = 'flex';
        }

        function saveAdvancedPalette() {
            // Collect all color variations from the current display
            const colorCards = document.querySelectorAll('#paletteColors2 .color-card');
            let allColorVariations = [];
            
            colorCards.forEach(card => {
                const variations = card.querySelectorAll('.color-variation');
                variations.forEach(variation => {
                    const hexValue = variation.querySelector('.color-value').textContent.replace('HEX: ', '');
                    allColorVariations.push(hexValue);
                });
            });
            
            const paletteData = {
                title: document.getElementById('paletteTitle2').textContent,
                baseColors: advancedCurrentPalette,
                allVariations: allColorVariations,
                timestamp: new Date().toISOString(),
                type: 'advanced'
            };
            
            // Save to localStorage
            const savedPalettes = JSON.parse(localStorage.getItem('savedAdvancedPalettes') || '[]');
            savedPalettes.push(paletteData);
            localStorage.setItem('savedAdvancedPalettes', JSON.stringify(savedPalettes));
            
            showCopyNotification();
            document.getElementById('copyNotification').textContent = 'Advanced palette saved! 💾';
        }

        function exportAdvancedPalette() {
            // Collect all color variations from the current display
            const colorCards = document.querySelectorAll('#paletteColors2 .color-card');
            let allColorVariations = [];
            
            colorCards.forEach(card => {
                const variations = card.querySelectorAll('.color-variation');
                variations.forEach(variation => {
                    const hexValue = variation.querySelector('.color-value').textContent.replace('HEX: ', '');
                    allColorVariations.push(hexValue);
                });
            });
            
            const paletteData = {
                title: document.getElementById('paletteTitle2').textContent,
                baseColors: advancedCurrentPalette,
                allVariations: allColorVariations,
                timestamp: new Date().toISOString(),
                type: 'advanced'
            };
            
            const dataStr = JSON.stringify(paletteData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `advanced-palette-${Date.now()}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
        }

        function copyAllAdvancedColors() {
            // Get all color variations from the current display
            const colorCards = document.querySelectorAll('#paletteColors2 .color-card');
            let allColors = [];
            
            colorCards.forEach(card => {
                const variations = card.querySelectorAll('.color-variation');
                variations.forEach(variation => {
                    const hexValue = variation.querySelector('.color-value').textContent.replace('HEX: ', '');
                    allColors.push(hexValue);
                });
            });
            
            const colorValues = allColors.join('\n');
            copyToClipboard(colorValues);
            document.getElementById('copyNotification').textContent = `All ${allColors.length} unique color variations copied! 📋`;
        }

        // Generate initial palette on page load
        window.addEventListener('load', () => {
            generatePalette();
        });
    </script>

    <p>Home/index <a href="index.html"></a></p>
</body>
</html>
